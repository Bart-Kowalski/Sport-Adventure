(() => {
var h=Object.defineProperty;var S=(t,e,n)=>e in t?h(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var l=(t,e,n)=>S(t,typeof e!="symbol"?e+"":e,n);const c=class c{constructor(){l(this,"data",new Map);l(this,"subscribers",new Set)}static getInstance(){return c.instance||(c.instance=new c),c.instance}getElementsByType(e){return this.data.get(e)??[]}setElements(e,n){this.data.set(e,n),this.notifySubscribers()}subscribe(e){return this.subscribers.has(e)?()=>{}:(this.subscribers.add(e),()=>this.subscribers.delete(e))}notifySubscribers(){const e=new Map(this.data);this.subscribers.forEach(n=>n(e))}};l(c,"instance");let f=c;const m=f.getInstance();function p(){var e;const t=document.querySelector(".brx-body");return((e=t==null?void 0:t.__vue_app__)==null?void 0:e.config.globalProperties.$_state)||null}function y(t,e){var n;return((n=t==null?void 0:t.content)==null?void 0:n.filter(s=>s.name===e))||[]}const d=new Set;function g(t,e=500){if(d.has(t))return()=>{};d.add(t);let n=new Set;const s=()=>{const r=p();if(!r){setTimeout(s,e);return}const o=y(r,t),u=new Set(o.map(i=>i.id));w(n,u)||(m.setElements(t,o),n=u),setTimeout(s,e)};return s(),()=>{d.delete(t)}}function w(t,e){return t.size===e.size&&[...t].every(n=>e.has(n))}const b="fr-notes";function E(t){const e=document.querySelector("#bricks-structure");return e?e.querySelector(`#element-${t}`):null}function I(t){let e=t;for(;e;){if(e.getAttribute("data-parent-id")==="0")return e;e=e.parentElement}return null}function q(t){const e=t.querySelector(".structure-item");if(!e)return;e.style.backgroundColor="var(--frames-notes-backdrop-color)",e.style.color="var(--frames-notes-highlight-color)";const n=e.querySelector(".icon");n&&(n.style.opacity="1")}function v(t){if(t.querySelector(".fr-notes-icon"))return;const e=document.createElement("span");e.innerHTML='<i class="ti-bookmark"></i>',e.classList.add("fr-notes-icon");const n=t.querySelector(".title");n&&n.prepend(e)}function P(t){const e=t.querySelector(".fr-notes-icon");e&&e.remove()}function k(){const t=new Set;m.subscribe(e=>{const n=m.getElementsByType(b)||[],s=new Set;n.forEach(r=>{const o=document.getElementById(`element-${r.id}`);if(!o)return;q(o);const u=E(r.id);if(!u)return;const i=I(u);if(!i)return;const a=i.getAttribute("data-id");i&&a&&!t.has(a)&&(v(i),t.add(a)),s.add(a||"")}),t.forEach(r=>{if(!s.has(r)){const o=document.querySelector(`[data-id="${r}"]`);if(!o)return;P(o),t.delete(r)}})}),g(b)}window.addEventListener("load",()=>{setTimeout(()=>{if(window.self!==window.top){console.log("Script running in iframe; stopping execution.");return}k()},500)});
})()